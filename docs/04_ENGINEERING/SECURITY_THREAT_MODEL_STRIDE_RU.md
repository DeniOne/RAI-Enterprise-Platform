# –ú–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —É–≥—Ä–æ–∑ (STRIDE) - Critical Paths

**–î–∞—Ç–∞:** 2026-02-16
**–°—Ç–∞—Ç—É—Å:** Draft / Baseline
**–ö–æ–Ω—Ç—É—Ä:** Critical Invariants (Multi-tenancy, Finance, Execution)

## 1. –ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è
–ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–≤–æ–¥–∏—Ç—Å—è –ø–æ –º–æ–¥–µ–ª–∏ **STRIDE**:
- **S**poofing (–ü–æ–¥–º–µ–Ω–∞ –ª–∏—á–Ω–æ—Å—Ç–∏)
- **T**ampering (–ü–æ–¥–º–µ–Ω–∞ –¥–∞–Ω–Ω—ã—Ö)
- **R**epudiation (–û—Ç–∫–∞–∑ –æ—Ç –∞–≤—Ç–æ—Ä—Å—Ç–≤–∞)
- **I**nformation Disclosure (–†–∞—Å–∫—Ä—ã—Ç–∏–µ –¥–∞–Ω–Ω—ã—Ö)
- **D**enial of Service (–û—Ç–∫–∞–∑ –≤ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–∏)
- **E**levation of Privilege (–ü–æ–≤—ã—à–µ–Ω–∏–µ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π)

---

## 2. –ê–Ω–∞–ª–∏–∑ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø–æ—Ç–æ–∫–æ–≤

### A. Tenant Data Access (Multi-tenancy)
*–ö–æ–Ω—Ç–µ–∫—Å—Ç: –î–æ—Å—Ç—É–ø –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∫ —Ä–µ—Å—É—Ä—Å–∞–º (Fields, Accounts).*

| –£–≥—Ä–æ–∑–∞ | –û–ø–∏—Å–∞–Ω–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏—è | –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å | –£—â–µ—Ä–± | Mitigations (–ü—Ä–∏–Ω—è—Ç—ã–µ –º–µ—Ä—ã) | –°—Ç–∞—Ç—É—Å |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **Spoofing** | –ê—Ç–∞–∫—É—é—â–∏–π –ø–æ–¥–¥–µ–ª—ã–≤–∞–µ—Ç JWT —Ç–æ–∫–µ–Ω –¥—Ä—É–≥–æ–≥–æ —Ç–µ–Ω–∞–Ω—Ç–∞. | Low | Critical | –ü–æ–¥–ø–∏—Å—å RS256/HS256, –≤–∞–ª–∏–¥–∞—Ü–∏—è `companyId` –≤ payload. | ‚úÖ Closed |
| **Tampering** | –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è `companyId` –≤ URL/Body –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ. | High | Critical | **Tenant Middleware**: –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –ø–µ—Ä–µ–∑–∞–ø–∏—Å—å `where` —É—Å–ª–æ–≤–∏–π –≤ Prisma. | ‚úÖ Closed (Week 1) |
| **Info Disclosure** | –£—Ç–µ—á–∫–∞ –¥–∞–Ω–Ω—ã—Ö —á—É–∂–æ–≥–æ —Ç–µ–Ω–∞–Ω—Ç–∞ —á–µ—Ä–µ–∑ API (IDOR). | Medium | Critical | **Fail-closed middleware**, –∑–∞–ø—Ä–µ—Ç –∑–∞–ø—Ä–æ—Å–æ–≤ –±–µ–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞. | ‚úÖ Closed (Week 1) |
| **Elevation** | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ä–æ–ª—å—é `VIEWER` –≤—ã–ø–æ–ª–Ω—è–µ—Ç `WRITE`. | Medium | High | ‚ö†Ô∏è **OPEN**: –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç —Å—Ç—Ä–æ–≥–∏–π RBAC –Ω–∞ –≤—Å–µ—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞—Ö. | üî¥ **TODO (Next)** |

### B. Financial Ledger (Double Entry)
*–ö–æ–Ω—Ç–µ–∫—Å—Ç: –ü—Ä–æ–≤–æ–¥–∫–∏, –±–∞–ª–∞–Ω—Å—ã, –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ –∑–∞—Ä–ø–ª–∞—Ç.*

| –£–≥—Ä–æ–∑–∞ | –û–ø–∏—Å–∞–Ω–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏—è | –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å | –£—â–µ—Ä–± | Mitigations (–ü—Ä–∏–Ω—è—Ç—ã–µ –º–µ—Ä—ã) | –°—Ç–∞—Ç—É—Å |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **Tampering** | –ü—Ä—è–º–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ –≤ –ë–î –º–∏–º–æ –ª–æ–≥–∞ –ø—Ä–æ–≤–æ–¥–æ–∫. | Low (Internal) | Critical | **Immutability Triggers**: –∑–∞–ø—Ä–µ—Ç UPDATE/DELETE –Ω–∞ `LedgerEntry`. | ‚úÖ Closed (Week 1) |
| **Repudiation** | "–Ø –Ω–µ —Å–æ–∑–¥–∞–≤–∞–ª —ç—Ç—É –ø—Ä–æ–≤–æ–¥–∫—É". | Medium | High | **Audit Log**: —Ñ–∏–∫—Å–∞—Ü–∏—è `userId`, `ip`, `reason`. | ‚úÖ Closed |
| **Tampering** | Race Condition: —Å–ø–∏—Å–∞–Ω–∏–µ —Å—Ä–µ–¥—Å—Ç–≤ –¥–≤–∞–∂–¥—ã. | Medium | High | **Optimistic Locking** (`version`), Idempotency Keys. | ‚úÖ Closed (Week 1) |

### C. Execution Engine (Agro Operations)
*–ö–æ–Ω—Ç–µ–∫—Å—Ç: –°–ø–∏—Å–∞–Ω–∏–µ –¢–ú–¶ (—Å–µ–º–µ–Ω–∞, —Ö–∏–º–∏—è) –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ —Ä–∞–±–æ—Ç.*

| –£–≥—Ä–æ–∑–∞ | –û–ø–∏—Å–∞–Ω–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏—è | –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å | –£—â–µ—Ä–± | Mitigations (–ü—Ä–∏–Ω—è—Ç—ã–µ –º–µ—Ä—ã) | –°—Ç–∞—Ç—É—Å |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **Spoofing** | –§–∏–∫—Ç–∏–≤–Ω—ã–π –æ—Ç—á–µ—Ç –æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ —Ä–∞–±–æ—Ç—ã (—Å–ø–∏—Å–∞–Ω–∏–µ –¢–ú–¶ "–Ω–∞–ª–µ–≤–æ"). | High (Fraud) | Medium | –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è, –≥–µ–æ-–≤–∞–ª–∏–¥–∞—Ü–∏—è (–≤ –ø–ª–∞–Ω–∞—Ö). | üü° Partial |
| **Tampering** | –ò–∑–º–µ–Ω–µ–Ω–∏–µ –Ω–æ—Ä–º –≤–Ω–µ—Å–µ–Ω–∏—è –≤ —Ç–µ—Ö–∫–∞—Ä—Ç–µ –∑–∞–¥–Ω–∏–º —á–∏—Å–ª–æ–º. | Medium | High | –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ—Ö–∫–∞—Ä—Ç, –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –∞–∫—Ç–∏–≤–Ω–æ–º —Å–µ–∑–æ–Ω–µ. | ‚úÖ Closed |

---

## 3. –ü–ª–∞–Ω —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π (Remediation Plan)

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç P0 (–ë–ª–æ–∫–∏—Ä—É—é—â–∏–µ)
1.  **RBAC Enforcement**: –ó–∞–∫—Ä—ã—Ç—å —Ä–∏—Å–∫ *Elevation of Privilege*. –í–Ω–µ–¥—Ä–∏—Ç—å `RolesGuard` –Ω–∞ –≤—Å–µ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã.
    *   *–°–≤—è–∑—å —Å —á–µ–∫–ª–∏—Å—Ç–æ–º:* "–í–Ω–µ–¥—Ä–∏—Ç—å strict authz (least privilege)"
2.  **Infrastructure Protection**: –ó–∞–∫—Ä—ã—Ç—å —Ä–∏—Å–∫ *Denial of Service*. –í–Ω–µ–¥—Ä–∏—Ç—å Rate Limiting.
    *   *–°–≤—è–∑—å —Å —á–µ–∫–ª–∏—Å—Ç–æ–º:* "–í–∫–ª—é—á–∏—Ç—å WAF/rate limiting"

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç P1 (–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ)
1.  **Secret Rotation**: –£–º–µ–Ω—å—à–∏—Ç—å impact –æ—Ç —É—Ç–µ—á–∫–∏ –∞–¥–º–∏–Ω—Å–∫–∏—Ö –∫—Ä–µ–¥–æ–≤.
    *   *–°–≤—è–∑—å —Å —á–µ–∫–ª–∏—Å—Ç–æ–º:* "–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–µ–∫—Ä–µ—Ç—ã –∏ —Ä–æ—Ç–∞—Ü–∏—é"

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ
–ù–∞–∏–±–æ–ª—å—à–∏–π –Ω–µ–∑–∞–∫—Ä—ã—Ç—ã–π –≤–µ–∫—Ç–æ—Ä –∞—Ç–∞–∫–∏ –Ω–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç ‚Äî **Elevation of Privilege** –≤–Ω—É—Ç—Ä–∏ —Ç–µ–Ω–∞–Ω—Ç–∞ (–ø—Ä–æ–±–ª–µ–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏) –∏ **DoS** (–æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ª–∏–º–∏—Ç–æ–≤). –§—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è –∏–∑–æ–ª—è—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö (Information Disclosure –º–µ–∂–¥—É —Ç–µ–Ω–∞–Ω—Ç–∞–º–∏) –∑–∞–∫—Ä—ã—Ç–∞ —É—Å–ø–µ—à–Ω–æ.
