---
id: DOC-DOM-GEN-058
type: Domain Spec
layer: Domain
status: Draft
version: 0.1.0
owners: [@techlead]
last_updated: 2026-02-15
---

---
id: component-rai-agro-techmap
type: component
status: review
owners: [domain-experts, architects]
aligned_with: [principle-vision]
---

# Domain: Detailed Agro-Tech Map (АТК — Арго-Технологическая Карта)

> **Contour:** 2 (Operations) & 1 (Enterprise) | **Module:** TechMap Builder  
> **Status:** ARCHITECTURAL DEFINITION  
> **Key Principle:** Детализация = Ценность. Карта содержит полное описание процесса "от почвы до элеватора" с точностью до часов.

---

## 1. Назначение
Создание мастер-плана возделывания культуры на конкретном поле, учитывающего:
- **Агрохиманализ**: Текущее состояние почвы.
- **Историю поля**: Предшественники, прошлые болезни.
- **Климат**: Прогнозные и исторические данные погоды.
- **Регламенты**: Строгие правила по ДВ, дозировкам и окнам внесения.

---

## 2. Структура Карты (АТК)

### 2.1. Слой 1: Стратегический (Этапы)
- 16 этапов (по Рапсу), зафиксированные в FSM.
- Целевые показатели (урожайность, масличность).

### 2.2. Слой 2: Технологический (Операции)
- Почасовой регламент работ.
- **Параметры**: Скорость агрегата, глубина заделки, температура воздуха при внесении.
- **Ресурсы**: Конкретные СЗР, удобрения, семена (с расчетом дозировок).

### 2.3. Слой 3: Рисковый (Условная логика)
- "Если влажность > X, то операция Y переносится".
- "Если обнаружен вредитель Z, то добавить инсектицид W".

---

## 3. Интеграция в CMR (Consulting CRM)

В CMR детальная карта (АТК) выполняет роль **Контрактного Эталона**.

### 3.1. Визуализация в CMR
- В CMR мы не показываем всю "простыню" операций по умолчанию.
- Мы показываем **отклонения** факта от АТК.
- **Decision Log** в CMR строится на базе осознанных отступлений от АТК или реакций на риски, заложенные в ней.

### 3.2. Роль ИИ
1.  **Генератор**: ИИ собирает все вводные (анализ почвы, погода) и верстает АТК.
2.  **Контролер**: ИИ следит за выполнением АТК в реальном времени.
3.  **Оптимизатор**: При изменении условий (ливень, поломка) ИИ пересчитывает оставшуюся часть АТК.

---

## 4. Схема данных (Предложение к Prisma)

- `TechMap`: Основной контейнер.
- `MapOperation`: Операция с почасовым слотом и связкой с фазой.
- `MapCondition`: Условия ветвления (Inference logic).
- `MapResourceRequirement`: Что нужно для выполнения.
