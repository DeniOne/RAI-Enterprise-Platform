# TASK: REFACORING CRM "PARTIES" (КОНТРАГЕНТЫ) - ENTERPRISE ENTITY HUB
Ты — Senior Frontend / React Engineer. Твоя задача — полностью переработать UI/UX создания и редактирования сущности "Контрагент" (Party) в ERP системе (стек: Next.js App Router, React, TypeScript, Tailwind CSS, Ant Design, React Hook Form + Zod).

## КОНТЕКСТ И ПРОБЛЕМАТИКА
Текущая реализация через жесткий многошаговый Wizard (6 шагов) признана неудачной. Если API автозаполнения (DaData) не срабатывает, форма блокируется. Это недопустимо в Enterprise-системах.

**Новая архитектура UX делится на 2 части:**
1. **Quick Create Drawer (Быстрое создание):** Боковая шторка для минимального старта.
2. **Party Entity Hub (Карточка контрагента):** Полноценная страница `[id]/page.tsx` с вкладками (Tabs) для детального редактирования массивов данных.

## СТРОГИЕ ПРАВИЛА (UX CANON)
- **НИКАКИХ БЛОКИРОВОК:** Автозаполнение (DaData) — это лишь помощник. Если API упало или данных нет, пользователь ОБЯЗАН иметь возможность вписать всё руками.
- **ДИНАМИЧЕСКИЕ МАССИВЫ:** Один контрагент может иметь много адресов, счетов и контактных лиц. Используй `useFieldArray` из `react-hook-form` для динамического добавления/удаления строк.
- **ИЗОЛЯЦИЯ:** Каждая вкладка Карточки должна быть отдельным компонентом, чтобы не создавать "God Object".

---

## ТРЕБОВАНИЯ К КОМПОНЕНТАМ (ЧТО НУЖНО НАПИСАТЬ)

### 1. `PartyQuickCreateDrawer.tsx`
- **Поля:** Юрисдикция (RU, BY, KZ), Тип (Юр.лицо, ИП), Идентификатор (ИНН/УНП).
- **Логика:** Кнопка "Найти". При успехе — предзаполняем поля (Название, КПП).
- **Важно:** Поля ввода всегда открыты для редактирования. Кнопка "Создать" просто отправляет базовый DTO на сервер и редиректит в Карточку.

### 2. Карточка Контрагента: `app/(app)/crm/parties/[id]/page.tsx`
- Layout с Header-ом (Название, статус, бейджи) и компонентом Tabs.

### 3. Вкладки (Tabs Components) - ВАЖНО: везде используем `useFieldArray`!

#### A. Вкладка "Основное и Реквизиты" (`PartyProfileTab.tsx`)
- Базовые инпуты (Название полное/краткое, ИНН, КПП, ОГРН и т.д. в зависимости от юрисдикции).
- **Адреса (Динамический список):** Возможность добавлять блоки адресов. Поля: `Тип адреса` (Селект: Юридический, Почтовый, Фактический, Адрес доставки), `Индекс`, `Регион`, `Город`, `Улица/Дом`.

#### B. Вкладка "Банковские счета" (`PartyBankAccountsTab.tsx`)
- **Счета (Динамический список):** Возможность добавить N-счетов. Поля: `Название счета` (Main/Secondary), `Расчетный счет`, `БИК`, `Название банка`, `Корр. счет`.

#### C. Вкладка "Ключевые лица / ЛОПР" (`PartyContactsTab.tsx`)
- **Контакты (Динамический список):** Карточки представителей. Поля:
  - `ФИО` (Строка)
  - `Должность` (Селект из справочника: Подписант, Генеральный директор, Главный агроном, Агроном, Главный бухгалтер, Иное).
  - `Телефон`, `Email`.
  - Чекбокс `Основной контакт`.

#### D. Вкладка "Связанные активы / Холдинг" (`PartyStructureTab.tsx`)
- (Пока сделать заглушку UI: сообщение "Здесь будет граф связей с хозяйствами и управляющими компаниями").

---

## ШАГИ ДЛЯ ИСПОЛНЕНИЯ (INSTRUCTIONS FOR AI)
1. **Сначала** проанализируй задачу и напиши краткий план (Structure) — какие файлы ты создашь или изменишь, и какие интерфейсы Zod опишешь для валидации динамических массивов.
2. **Остановись и дождись моего подтверждения плана.**
3. После моего ок — выдай готовый, чистый и production-ready код с использованием Tailwind CSS для красивой сеточной верстки (Grid/Flex) внутри вкладок, чтобы интерфейс выглядел как современный B2B продукт, а не свалка инпутов.