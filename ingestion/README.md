# Ingestion Worker (Sprint 1)

## Что делает
- Получает сообщения из очереди через абстрактный интерфейс транспорта.
- Валидирует входящие payload по существующим JSON Schema.
- Логирует `event_id`, `version`, `source`, `trace_id`.
- При успехе: подтверждает сообщение и передает payload без изменений.
- При ошибке валидации: пишет ошибку и останавливает обработку (без ретраев).

## Чего НЕ делает
- Никакой AI/ML/инференса/«умной» логики.
- Никаких рекомендаций или принятия решений.
- Никаких ретраев, DLQ или политик обработки ошибок.
- Никакого обогащения или трансформации данных.

## Smoke test
- Команда: `pnpm -C ingestion run smoke`.
- Используются примеры из `../contracts/examples`.
- Проверяется, что `ack()` вызван и ошибок нет.

## Заметки для Sprint 2
- Подключить конкретный брокер сообщений через реализацию `QueueClient`.
- Добавить ретраи и DLQ (только после согласованной политики).
- Настроить next-step пайплайна без изменения payload.
- Добавить эксплуатационные метрики (без AI-метрик).

## Структура
- `src/transport.ts` — абстрактный интерфейс очереди.
- `src/validation.ts` — валидация JSON Schema.
- `src/logging.ts` — структурный логгер.
- `src/worker.ts` — основной воркер.
- `src/index.ts` — точка входа.
- `src/smoke.ts` — smoke test.

## Примечание
Схемы читаются из `../contracts` относительно каталога `ingestion`.
